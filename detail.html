<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Volshebnik Books ‚Äî –î–µ—Ç–∞–ª–∏ –∫–Ω–∏–≥–∏</title>
    <meta name="description"
        content="–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–Ω–∏–≥–µ –≤ Volshebnik Books ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ, –∞–≤—Ç–æ—Ä, —Ü–µ–Ω–∞ –∏ –æ—Ç–∑—ã–≤—ã." />
    <meta name="keywords" content="–∫–Ω–∏–≥–∏, –¥–µ—Ç–∞–ª–∏ –∫–Ω–∏–≥–∏, Volshebnik Books, –¥–æ—Å—Ç–∞–≤–∫–∞ –∫–Ω–∏–≥, –∫—É–ø–∏—Ç—å –∫–Ω–∏–≥—É" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://volshebnik.uz/book-details" />
    <link rel="icon" href="https://volshebnik.uz/favicon.ico" type="image/x-icon" />

    <!-- Open Graph -->
    <meta property="og:title" content="Volshebnik Books ‚Äî –î–µ—Ç–∞–ª–∏ –∫–Ω–∏–≥–∏" />
    <meta property="og:description"
        content="–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–Ω–∏–≥–µ –≤ Volshebnik Books ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ, –∞–≤—Ç–æ—Ä, —Ü–µ–Ω–∞ –∏ –æ—Ç–∑—ã–≤—ã." />
    <meta property="og:url" content="https://volshebnik.uz/book-details" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://images.unsplash.com/photo-1512820790803-83ca734da794" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Volshebnik Books ‚Äî –î–µ—Ç–∞–ª–∏ –∫–Ω–∏–≥–∏" />
    <meta name="twitter:description"
        content="–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–Ω–∏–≥–µ –≤ Volshebnik Books ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ, –∞–≤—Ç–æ—Ä, —Ü–µ–Ω–∞ –∏ –æ—Ç–∑—ã–≤—ã." />
    <meta name="twitter:image" content="https://images.unsplash.com/photo-1512820790803-83ca734da794" />

    <!-- –°—Ç–∏–ª–∏ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        #scrollTopBtn {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background-color: #2563eb;
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 10px rgb(37 99 235 / 0.6);
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            z-index: 60;
        }

        @media (min-width: 768px) {
            #scrollTopBtn {
                width: 48px;
                height: 48px;
                bottom: 3rem;
                right: 3rem;
            }
        }

        #scrollTopBtn.show {
            opacity: 1;
            pointer-events: auto;
        }

        /* –ü–ª–∞–≤–Ω–∞—è —Å–º–µ–Ω–∞ –æ–±–ª–æ–∂–∫–∏ */
        #book-cover {
            transition: opacity 0.3s ease-in-out;
        }

        #gallery-thumbs img {
            border: 2px solid transparent;
            transition: border-color 0.3s;
        }

        #gallery-thumbs img.active {
            border-color: #2563eb;
        }

        /* –û—Ç–∑—ã–≤—ã —Å —Ä–µ–π—Ç–∏–Ω–≥–æ–º */
        .review-rating {
            color: #fbbf24;
            /* –ñ–µ–ª—Ç—ã–π —Ü–≤–µ—Ç –∑–≤–µ–∑–¥ */
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }

        /* –õ–æ–∞–¥–µ—Ä */
        .loader {
            border: 6px solid #f3f3f3;
            border-top: 6px solid #2563eb;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            animation: spin 1s linear infinite;
            margin: 40px auto;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body class="bg-gray-50 flex min-h-screen flex-col">

    <!-- –•–µ–¥–µ—Ä -->
    <header
        class="fixed top-0 left-0 right-0 bg-white/90 backdrop-blur border-b border-gray-200 shadow-sm flex justify-between items-center px-3 sm:px-6 py-3 z-40">
        <div class="flex items-center space-x-3">
            <h1 class="text-xl font-semibold text-gray-800 cursor-pointer" onclick="location.href='./index.html'"
                tabindex="0" role="link" aria-label="–ù–∞ –≥–ª–∞–≤–Ω—É—é Volshebnik Books">
                Volshebnik Books
            </h1>
        </div>
        <nav class="hidden md:flex space-x-6 text-sm text-gray-600" aria-label="–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è">
            <div>üìû <a href="tel:+998901234567" class="hover:underline">+998 90 123 45 67</a></div>
            <div>‚úâ <a href="mailto:info@volshebnik.uz" class="hover:underline">info@volshebnik.uz</a></div>
            <div>üè¢ –¢–∞—à–∫–µ–Ω—Ç, –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω</div>
        </nav>
    </header>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <main class="pt-20 max-w-7xl mx-auto p-2 sm:p-4 md:p-6 flex-grow mt-16" role="main">
        <div id="loader" class="loader" aria-label="–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∫–Ω–∏–≥–∏" role="status"></div>

        <div id="content" class="hidden grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-10" aria-live="polite">
            <!-- –ì–∞–ª–µ—Ä–µ—è —Å –æ–±–ª–æ–∂–∫–æ–π –∏ –º–∏–Ω–∏–∞—Ç—é—Ä–∞–º–∏ -->
            <section aria-label="–ì–∞–ª–µ—Ä–µ—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∫–Ω–∏–≥–∏"
                class="flex flex-col justify-center items-center bg-white rounded-xl shadow-lg p-4 sm:p-6">
                <img id="book-cover" src="https://via.placeholder.com/400x600?text=–ó–∞–≥—Ä—É–∑–∫–∞..." alt="–û–±–ª–æ–∂–∫–∞ –∫–Ω–∏–≥–∏"
                    class="rounded-lg max-h-[400px] object-contain mb-4" />

                <div id="gallery-thumbs" class="flex space-x-3 overflow-x-auto max-w-full" tabindex="0">
                    <!-- –ú–∏–Ω–∏–∞—Ç—é—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å—é–¥–∞ —Å–∫—Ä–∏–ø—Ç–æ–º -->
                </div>
            </section>

            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–Ω–∏–≥–µ -->
            <section
                class="bg-white rounded-xl shadow-lg p-4 sm:p-6 flex flex-col justify-between max-w-full sm:max-w-[600px]"
                aria-label="–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–Ω–∏–≥–µ">
                <div>
                    <h2 id="book-title" class="text-3xl font-bold mb-3 text-gray-900">–ó–∞–≥—Ä—É–∑–∫–∞...</h2>
                    <p class="text-gray-600 mb-2">–ê–≤—Ç–æ—Ä: <span id="book-author" class="font-semibold">‚Äì</span></p>
                    <p class="text-gray-600 mb-2">–ñ–∞–Ω—Ä: <span id="book-genre" class="font-semibold">‚Äì</span></p>
                    <p class="text-gray-600 mb-2">–ò–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ: <span id="book-publisher" class="font-semibold">‚Äì</span>
                    </p>
                    <p class="text-gray-600 mb-2">–ì–æ–¥ –∏–∑–¥–∞–Ω–∏—è: <span id="book-year" class="font-semibold">‚Äì</span></p>
                    <p class="text-gray-600 mb-6">ISBN: <span id="book-isbn" class="font-semibold">‚Äì</span></p>

                    <h3 class="text-xl font-semibold mb-2">–û–ø–∏—Å–∞–Ω–∏–µ</h3>
                    <p id="book-description" class="text-gray-700 leading-relaxed mb-6">–ó–∞–≥—Ä—É–∑–∫–∞ –æ–ø–∏—Å–∞–Ω–∏—è...</p>
                </div>

                <!-- –¶–µ–Ω–∞ –∏ –∫–Ω–æ–ø–∫–∞ -->
                <div class="mt-auto">
                    <div class="flex flex-col sm:flex-row sm:items-center sm:space-x-6 mb-4">
                        <div id="book-price" class="text-2xl font-bold text-blue-600 mb-3 sm:mb-0">‚Äì</div>
                        <button id="add-to-cart"
                            class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition disabled:opacity-50"
                            disabled aria-disabled="true" aria-label="–î–æ–±–∞–≤–∏—Ç—å –∫–Ω–∏–≥—É –≤ –∫–æ—Ä–∑–∏–Ω—É">
                            –í –∫–æ—Ä–∑–∏–Ω—É
                        </button>
                    </div>
                    <p class="text-sm text-gray-500">–î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –≤—Å–µ–º—É –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω—É ‚Äî 1-3 –¥–Ω—è</p>
                </div>
            </section>
        </div>

        <!-- –û—Ç–∑—ã–≤—ã -->
        <section class="mt-16 px-2 sm:px-0" aria-label="–û—Ç–∑—ã–≤—ã –æ –∫–Ω–∏–≥–µ">
            <h2 class="text-3xl font-bold text-blue-800 mb-10 text-center">–û—Ç–∑—ã–≤—ã –æ –∫–Ω–∏–≥–µ</h2>
            <div class="swiper mySwiper">
                <div class="swiper-wrapper" id="reviews-container">
                    <!-- –û—Ç–∑—ã–≤—ã –±—É–¥—É—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å—é–¥–∞ -->
                </div>

                <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
                <button class="swiper-button-prev !text-blue-600" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–∏–π –æ—Ç–∑—ã–≤"></button>
                <button class="swiper-button-next !text-blue-600" aria-label="–°–ª–µ–¥—É—é—â–∏–π –æ—Ç–∑—ã–≤"></button>
            </div>
        </section>
    </main>

    <!-- –§—É—Ç–µ—Ä -->
    <footer class="bg-gray-100 border-t border-gray-300 py-8 px-4 sm:px-6 text-gray-700 text-sm md:text-base mt-auto"
        role="contentinfo">
        <div
            class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center md:items-start space-y-6 md:space-y-0">
            <div>
                <h3 class="font-semibold mb-2 text-gray-900">Volshebnik Books</h3>
                <p class="max-w-xl">
                    –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω –∫–Ω–∏–≥ —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π –ø–æ –¢–∞—à–∫–µ–Ω—Ç—É –∏ –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω—É. –ú—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –ª—É—á—à–∏–µ –∫–Ω–∏–≥–∏, –Ω–æ–≤–∏–Ω–∫–∏ –∏
                    –≤—ã–≥–æ–¥–Ω—ã–µ –∞–∫—Ü–∏–∏.
                </p>
            </div>
            <div>
                <h4 class="font-semibold mb-2 text-gray-900">–ö–æ–Ω—Ç–∞–∫—Ç—ã</h4>
                <ul>
                    <li>
                        –¢–µ–ª–µ—Ñ–æ–Ω:
                        <a href="tel:+998901234567" class="hover:underline">+998 90 123 45 67</a>
                    </li>
                    <li>
                        Email:
                        <a href="mailto:info@volshebnik.uz" class="hover:underline">info@volshebnik.uz</a>
                    </li>
                    <li>–ê–¥—Ä–µ—Å: –¢–∞—à–∫–µ–Ω—Ç, –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω</li>
                </ul>
            </div>
        </div>
    </footer>

    <!-- –ö–Ω–æ–ø–∫–∞ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –≤–≤–µ—Ä—Ö -->
    <button id="scrollTopBtn" aria-label="–ù–∞–≤–µ—Ä—Ö" title="–ù–∞–≤–µ—Ä—Ö" tabindex="0">
        ‚Üë
    </button>

    <script>
        // –§—É–Ω–∫—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–µ–Ω—ã (—Å –ø—Ä–æ–±–µ–ª–∞–º–∏)
        function formatPrice(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ") + " —Å—É–º";
        }

        // –õ–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã
        function saveToCart(book) {
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∫–Ω–∏–≥–∞ –≤ –∫–æ—Ä–∑–∏–Ω–µ
            if (cart.find(item => item.id === book.id)) {
                alert('–≠—Ç–∞ –∫–Ω–∏–≥–∞ —É–∂–µ –≤ –∫–æ—Ä–∑–∏–Ω–µ');
                return;
            }
            cart.push(book);
            localStorage.setItem('cart', JSON.stringify(cart));
            alert('–ö–Ω–∏–≥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –∫–æ—Ä–∑–∏–Ω—É!');
        }

        // –ü–æ–∫–∞–∑ –∫–Ω–æ–ø–∫–∏ "–ù–∞–≤–µ—Ä—Ö" –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ
        const scrollBtn = document.getElementById('scrollTopBtn');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 400) {
                scrollBtn.classList.add('show');
            } else {
                scrollBtn.classList.remove('show');
            }
        });
        scrollBtn.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ URL
        function getQueryParam(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –æ—Ç–∑—ã–≤–æ–≤ —Å —Ä–µ–π—Ç–∏–Ω–≥–æ–º
        function renderReviews(reviews) {
            const container = document.getElementById('reviews-container');
            container.innerHTML = ''; // –æ—á–∏—Å—Ç–∏—Ç—å

            reviews.forEach(review => {
                const starsCount = Math.min(5, Math.max(1, review.rating)); // –æ—Ç 1 –¥–æ 5
                let starsHtml = '';
                for (let i = 1; i <= 5; i++) {
                    starsHtml += i <= starsCount ? '‚òÖ' : '‚òÜ';
                }

                const reviewEl = document.createElement('div');
                reviewEl.className = 'swiper-slide bg-white rounded-lg shadow p-6 max-w-md mx-auto';
                reviewEl.innerHTML = `
                    <div class="review-rating" aria-label="–†–µ–π—Ç–∏–Ω–≥ ${starsCount} –∏–∑ 5">${starsHtml}</div>
                    <p class="text-gray-800 italic mb-4">"${review.comment}"</p>
                    <p class="text-gray-600 font-semibold text-right">‚Äî ${review.author}</p>
                `;
                container.appendChild(reviewEl);
            });

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Swiper –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–ª–∞–π–¥–æ–≤
            new Swiper('.mySwiper', {
                loop: true,
                navigation: {
                    nextEl: '.swiper-button-next',
                    prevEl: '.swiper-button-prev',
                },
                slidesPerView: 1,
                autoHeight: true,
            });
        }

        async function loadBookData(slug) {
            const loader = document.getElementById('loader');
            const content = document.getElementById('content');

            loader.style.display = 'block';
            content.classList.add('hidden');

            try {
                if (!slug) {
                    throw new Error('–ù–µ —É–∫–∞–∑–∞–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä –∫–Ω–∏–≥–∏');
                }

                // –§–æ—Ä–º–∏—Ä—É–µ–º URL —Å —É—á—ë—Ç–æ–º —Ç–≤–æ–µ–≥–æ API
                const apiUrl = `https://volshebnik.uz/site/api/products/${encodeURIComponent(slug)}`;

                const response = await fetch(apiUrl);
                if (!response.ok) {
                    throw new Error('–ö–Ω–∏–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                }
                const data = await response.json();

                // –í —Ç–≤–æ—ë–º API —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è ‚Äî –Ω–∞–¥–æ –ø–æ–¥—Å—Ç—Ä–æ–∏—Ç—å—Å—è
                // –ü—Ä–∏–º–µ—Ä –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:
                /*
                {
                  id: string,
                  title: string,
                  author: string,
                  genre: string,
                  publisher: string,
                  year: number,
                  isbn: string,
                  description: string,
                  price: number,
                  images: [string],
                  reviews: [
                    { author: string, comment: string, rating: number }
                  ]
                }
                */

                // –ü—Ä–æ–≤–µ—Ä–∏–º –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏–º –æ–±—ä–µ–∫—Ç –∫–Ω–∏–≥–∏ –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏
                const book = {
                    id: data.id || slug,
                    title: data.title || '–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç',
                    author: data.author || '–ê–≤—Ç–æ—Ä –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω',
                    genre: data.genre || '–ñ–∞–Ω—Ä –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω',
                    publisher: data.publisher || '–ò–∑–¥–∞—Ç–µ–ª—å –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω',
                    year: data.year || '–ì–æ–¥ –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω',
                    isbn: data.isbn || 'ISBN –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç',
                    description: data.description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç',
                    price: data.price || 0,
                    images: data.images && data.images.length ? data.images : ['https://via.placeholder.com/400x600?text=–ù–µ—Ç+–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è'],
                    reviews: data.reviews || []
                };

                fillBookDetails(book);

            } catch (error) {
                console.warn('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö:', error.message);

            } finally {
                loader.style.display = 'none';
                content.classList.remove('hidden');
            }
        }
        // –ó–∞–ø–æ–ª–Ω—è–µ–º –¥–µ—Ç–∞–ª–∏ –∫–Ω–∏–≥–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
        function fillBookDetails(book) {
            // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –∏–Ω—Ñ–æ
            document.getElementById('book-title').textContent = book.title;
            document.getElementById('book-author').textContent = book.author;
            document.getElementById('book-genre').textContent = book.genre;
            document.getElementById('book-publisher').textContent = book.publisher;
            document.getElementById('book-year').textContent = book.year;
            document.getElementById('book-isbn').textContent = book.isbn;
            document.getElementById('book-description').textContent = book.description;

            // –¶–µ–Ω–∞ –∏ –∫–Ω–æ–ø–∫–∞
            const priceEl = document.getElementById('book-price');
            const addToCartBtn = document.getElementById('add-to-cart');
            priceEl.textContent = formatPrice(book.price);
            addToCartBtn.disabled = false;
            addToCartBtn.setAttribute('aria-disabled', 'false');

            // –û–±–ª–æ–∂–∫–∞
            const coverImg = document.getElementById('book-cover');
            if (book.images && book.images.length > 0) {
                coverImg.src = 'https://volshebnik.uz/site' + book.images[0].image ?? '';
                coverImg.alt = `–û–±–ª–æ–∂–∫–∞ –∫–Ω–∏–≥–∏ "${book.title}"`;
            } else {
                coverImg.src = 'https://via.placeholder.com/400x600?text=–ù–µ—Ç+–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è';
                coverImg.alt = '–û–±–ª–æ–∂–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç';
            }

            // –ì–∞–ª–µ—Ä–µ—è –º–∏–Ω–∏–∞—Ç—é—Ä
            const thumbsContainer = document.getElementById('gallery-thumbs');
            thumbsContainer.innerHTML = '';
            if (book.images && book.images.length > 1) {
                book.images.forEach((src, index) => {
                    const thumb = document.createElement('img');
                    thumb.src = 'https://volshebnik.uz/site' + src.image;
                    thumb.alt = `–ú–∏–Ω–∏–∞—Ç—é—Ä–∞ ${index + 1} –∫–Ω–∏–≥–∏ "${book.title}"`;
                    thumb.className = index === 0 ? 'rounded-lg cursor-pointer active' : 'rounded-lg cursor-pointer';
                    thumb.width = 80;
                    thumb.height = 120;
                    thumb.tabIndex = 0;
                    thumb.setAttribute('role', 'button');
                    thumb.setAttribute('aria-pressed', index === 0 ? 'true' : 'false');
                    thumb.addEventListener('click', () => switchCoverImage('https://volshebnik.uz/site' +src.image, index, thumbsContainer));
                    thumb.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            switchCoverImage('https://volshebnik.uz/site' +src.image, index, thumbsContainer);
                        }
                    });
                    thumbsContainer.appendChild(thumb);
                });
            }

            // –û—Ç–∑—ã–≤—ã
            if (book.reviews && book.reviews.length > 0) {
                renderReviews(book.reviews);
            } else {
                document.getElementById('reviews-container').innerHTML = '<p class="text-center text-gray-500">–û—Ç–∑—ã–≤–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç.</p>';
            }

            // –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É
            addToCartBtn.onclick = () => saveToCart({
                id: book.id,
                title: book.title,
                author: book.author,
                price: book.price,
                cover: book.images ? book.images[0] : ''
            });
        }

        // –°–º–µ–Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–π –æ–±–ª–æ–∂–∫–∏ –ø–æ –∫–ª–∏–∫—É
        function switchCoverImage(src, index, container) {
            const coverImg = document.getElementById('book-cover');
            // –ü–ª–∞–≤–Ω–æ —Å–∫—Ä—ã–≤–∞–µ–º
            coverImg.style.opacity = '0';
            setTimeout(() => {
                coverImg.src = src;
                coverImg.style.opacity = '1';
            }, 300);

            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –º–∏–Ω–∏–∞—Ç—é—Ä
            [...container.children].forEach((img, i) => {
                img.classList.toggle('active', i === index);
                img.setAttribute('aria-pressed', i === index ? 'true' : 'false');
            });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', () => {
            const slug = getQueryParam('id') || 'test-book-001';
            loadBookData(slug);
        });
    </script>
</body>

</html>